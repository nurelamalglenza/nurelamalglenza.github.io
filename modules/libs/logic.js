!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Logic=b()}(this,function(){function c(c,d){if("function"==typeof c&&(c=c()),"[object Object]"!==a.call(c))throw new b("Logic.js: Invalid states object: `"+c+"`.");var e,f=[],g=function(){for(var a=f.slice(),b=0,c=a.length;b<c;b++)a[b].apply(this,arguments)},h={getMachineState:function(){return e.name},setMachineState:function a(c){var f,j,d=arguments[1],k=e;if("string"==typeof c&&(c=h[c]),!c||!c.name||!h[c.name])throw new b("Logic.js: Transitioned into invalid state: `"+a.caller+"`.");return e=c,f=i["onenter"+e.name]||i["on"+e.name],f&&"function"==typeof f&&f.call(h,d,k.name,c.name),j=i["onleave"+k.name],j&&"function"==typeof j&&j.call(h,d,k.name,c.name),g.call(h,d,k.name,c.name),this},getMachineEvents:function(){var b=[];for(var c in e)e.hasOwnProperty(c)&&"function"==typeof e[c]&&b.push(c);return b}},i={getMachineState:h.getMachineState,getMachineEvents:h.getMachineEvents,bind:function(b){return b&&f.push(b),this},unbind:function(b){if(b)for(var c=0,d=f.length;c<d;c++)f[c]===b&&f.splice(c,1);else f=[];return this}},j=function(c,d,f){return function(){var g,j,k,l=i;return h[c]!==e?(f&&(l=f.apply(h,arguments)),l):(g=i["onbefore"+d],g&&"function"==typeof g&&g.call(h,d,e.name,e.name),l=h[c][d].apply(h,arguments),"undefined"==typeof l?(k=e,l=i):"string"==typeof l?(k=h[l],l=i):"[object Object]"===a.call(l)?(k=l===h?e:l,l=i):"[object Array]"===a.call(l)&&l.length>=1&&(k="string"==typeof l[0]?h[l[0]]:l[0],l=l[1]),j=i["onafter"+d]||i["on"+d],j&&"function"==typeof j&&j.call(h,d,e.name,k.name),h.setMachineState(k,d),l)}};for(var k in c)if(c.hasOwnProperty(k)){h[k]=c[k];for(var l in h[k])h[k].hasOwnProperty(l)&&("string"==typeof h[k][l]&&(h[k][l]=function(a){return function(){return this[a]}}(h[k][l])),"function"==typeof h[k][l]&&(i[l]=j(k,l,i[l])));h[k].name=k,e||(e=h[k])}if("undefined"!=typeof h[d]&&(e=h[d]),!e)throw new b("Logic.js: Invalid initial state.");return i}var a=Object.prototype.toString,b=function(){function a(a){this.name="InvalidStateError",this.message=a}return a.prototype=new Error,a.prototype.constructor=a,a}();return c.machine=function(b,d){return new c(b,d)},c.InvalidStateError=b,c});
